$(document).ready(function () {
    /*function setup_for_width(mql) {
        if (mql.matches) {
           addScroller(document.getElementById("tmenu"));
        } else {
           removeScroller(document.getElementById("tmenu")); 
        }
    }
    var mql = window.matchMedia("screen and (max-width: 767px)"); 
    mql.addListener(setup_for_width); // Добавим прослушку на смену результата
    setup_for_width(mql); // Вызовем нашу функцию*/





$('.top_menu--drop span').click(function(){ $(this).parent().toggleClass('is-active');})
$('.spoiler > p').click(function(){ $(this).parent().toggleClass('active');})
$('#vakansii input[name="telefon"]').mask("+7 (999) 999-9999");



    //  ---------- Слайдер принципы -------------- 

    owlPrincp = $('.princip_slider').owlCarousel({
        loop: true,
        margin: 0,
        nav: true,
        dots: false,
        items: 1
    });

    $('.tabs ul li span').click(function(){
        $('.tabs ul').toggleClass('is-open');
        $('.tabs').toggleClass('pdn70');
    });
    $('.js-show-more span').click(function(){
        $('.is-hidden').toggleClass('is-open');
        $(this).html($(this).html() == 'Читать далее >>' ? 'Свернуть' : 'Читать далее >>');
    });


    if(window.matchMedia('(max-width: 540px)').matches)

    {
        function shortPrincp(){
          var fullPrincp=[];
          $('.princip_sl').each(function(i,elem){
            $(elem).data('index',i);
            var text=$(elem).find('.princip_p').text();
            var fullPrincpWord =  $(elem).find('.princip_p').text().length;
            fullPrincp.push(text);
            if($(elem).find('.princip_p').text().length>100){         

              $(elem).find('.princip_p').text(text.substring(0,100)+'...');
              $(elem).find('.princip--more').click(function(e) {
                e.preventDefault();  
                $(elem).find('.princip_p').text(text.substring(0,fullPrincpWord));       
                $(elem).find('.princip--more').hide();
                owlRew.trigger('refresh.owl.carousel'); 
            });
          }
      });
      };

      shortPrincp();   
  }


    //  ---------- Слайдер популярное -------------- 

    $('.trust_slider ').owlCarousel({
        loop: true,
        margin: 0,
        nav: true,
        dots: true,
        responsive: {
            0: {
                items: 2,
                margin: 10
            },
            768: {
                items: 3,
                margin: 10
            },          
            1220: {
                items: 4,
                margin: 20
            }
        }
    }) 

    //  ---------- Слайдер отзывы -------------- 
    if(window.matchMedia('(max-width: 630px)').matches)

    {
        function shortRew(){
          var fullRew=[];
          $('.review_sl').each(function(i,elem){
            $(elem).data('index',i);             
            fullRew.push(text);

            if($(elem).find('.rev_text').text().length>242){

              var text=$(elem).find('.rev_text').text(); 
              var fullRewWord =  $(elem).find('.rev_text').text().length;               
              $(elem).find('.rev_read').addClass('rev_read--op');
              $(elem).find('.rev_text').text(text.substring(0,242)+'...');

              $(elem).find('.rev_read').click(function(e) {
                e.preventDefault();  
                $(elem).find('.rev_text').text(text.substring(0,fullRewWord));       
                $(elem).find('.rev_read').removeClass("rev_read--op");
                owlRew.trigger('refresh.owl.carousel'); 
            });
          }
      });
      };

      shortRew();
  }   


  owlRew = $('.review_slider').owlCarousel({
    loop: true,
    margin: 0,
    nav: true,
    dots: true,
    autoHeight: true,
    items: 1
});



    //  ---------- Слайдер статьи -------------- 

    $('.articl_slider').owlCarousel({
        loop: true,
        margin: 0,
        nav: true,
        dots: true,
        autoHeight: true,
        items: 1
    })    

    //  ---------- Слайдер новости -------------- 

    $('.news_slider').owlCarousel({
        loop: true,
        margin: 0,
        nav: true,
        dots: true,
        autoHeight: true,
        items: 1
    })    


    //  ---------- Кнопка наверх --------------

    $("#back-top").hide();

    $(function () {
        $(window).scroll(function () {
            if ($(this).scrollTop() > 10) {
                $('#back-top').fadeIn();
            } else {
                $('#back-top').fadeOut();
            }
        });

        $('#back-top a').click(function () {
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });
    });

    //  ---------- Закрытие fancybox  --------------
    $(function () {
        $("body").on("click", ".fancybox-close", function () {
            $.fancybox.close()
        });
        $("body").on("click", ".bClose", function () {
            $.fancybox.close()
        });
    });	  

    //  ---------- Раскрытие каталога -------------- 
    
    $('.katal_more').click(function (e) {  
        e.preventDefault();    
        $(".m_katal--list").toggleClass("m_katal--list-op");        
        $(this).toggleClass("katal_more--op");        
    });  

    //  ---------- Раскрытие преимуществ --------------   

    $('.m_wins_more').click(function (e) {  
        e.preventDefault();    
        $(".m_wins--list ").toggleClass("m_wins--list-op");        
        $(this).toggleClass("m_wins_more--op");        
    });


    //  ---------- Кнопка поиска -------------- 
    
    $('.hd_find--btn').click(function (e) {  
        e.preventDefault();    
        $(".hd_search_form").toggleClass("search_form--op");        
        $(this).toggleClass("hd_find--btnop");        
    });

    //  ---------- О компании раскрытие -------------- 

    $('.m_about--more').click(function (e) {  
        e.preventDefault();    
        $(".m_about--txt").toggleClass("m_about--op");     
    });

    //  ---------- Меню раскрытие -------------- 

    $('.top_menu--btn').click(function (e) {  
        e.preventDefault();    
        $('#tmenu').toggleClass("is--op"); 
        $(".top_menu").toggleClass("top_menu--op");     
        $(".overlay_menu").toggleClass("overlay_menu--op");  

        $('.overlay_menu--op').click(function (e) { 
            $('#tmenu').removeClass("is--op");  
            $(".top_menu").removeClass("top_menu--op");     
            $(".overlay_menu").removeClass("overlay_menu--op");        
        }); 
        $('.close_menu_icon').click(function (e) {
            $('#tmenu').removeClass("is--op");   
            $(".top_menu").removeClass("top_menu--op");     
            $(".overlay_menu").removeClass("overlay_menu--op");        
        });    
    });


       //  ---------- Меню раскрытие в хедере -------------- 

       if((window.matchMedia('(min-width: 768px)').matches) && (window.matchMedia('(max-width: 960px)').matches))

       {
          $('.top_menu--drop .top_menu--a').on("click",
              function(){
                  var open =  $(this).parents('.top_menu--drop').attr('data-open');

                  if(open == 'false'){
                    $('.top_menu--drop').attr('data-open','false').removeClass('menu_act1');
                    $(this).parents('.top_menu--drop').attr('data-open','true');
                    $(this).parents('.top_menu--drop').addClass('menu_act1');
                    return false;
                }

            });

          function openMenu1() {
            $('.top_menu--drop').each(function(index, el) {
                $(el).attr({
                    'data-open': 'false'
                });
            });
        }
        openMenu1();        
    }   



       //  ---------- Меню2 раскрытие в хедере -------------- 

    if(window.matchMedia('(max-width: 1024px)').matches)
    {
       $('.hd_menu--drop .hd_menu--a').on("click",
          function(){
              var open =  $(this).parents('.hd_menu--drop').attr('data-open');

              if(open == 'false'){
                $('.hd_menu--drop').attr('data-open','false').removeClass('menu_act2');
                $(this).parents('.hd_menu--drop').attr('data-open','true');
                $(this).parents('.hd_menu--drop').addClass('menu_act2');
                return false;
            }

        });

        function openMenu2() {
            $('.hd_menu--drop').each(function(index, el) {
                $(el).attr({
                    'data-open': 'false'
                });
            });
        }
        openMenu2();  
    }


});
(function($){               
    jQuery.fn.lightTabs = function(options){

        var createTabs = function(){
            tabs = this;
            i = 0;
            
            showPage = function(i){
                $(tabs).children("div").children("div").hide();
                $(tabs).children("div").children("div").eq(i).show();
                $(tabs).children("ul").children("li").removeClass("active");
                $(tabs).children("ul").children("li").eq(i).addClass("active");                
            }
            showPage(0);                
            
            $(tabs).children("ul").children("li").each(function(index, element){
                $(element).attr("data-page", i);
                i++;                        
            });
            
            $(tabs).children("ul").children("li").click(function(){
                if ($(this).hasClass("active")){

                }
                else{
                    $('.tabs ul').removeClass('is-open');
                    $('.tabs').removeClass('pdn70');
                }
                showPage(parseInt($(this).attr("data-page")));                 
            });                         
        };      
        return this.each(createTabs);
    };  
})(jQuery);

$(document).ready(function(){
    $(".tabs").lightTabs();

    $('a[href="about/"].top_menu--a').click(function(){
        $(this).attr('href','#');
        event.preventDefault();
    });
});